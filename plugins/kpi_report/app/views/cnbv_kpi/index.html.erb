<% content_for :header_tags do %>
  <%= stylesheet_link_tag 'bootstrap.min', 'mykpi', 'all', 'semantic', 'bootstrap-table.min', 'bootstrap-editable', plugin: 'kpi_report' %>
  <%= javascript_include_tag 'popper.min', 'jquery-2.0.3.min', 'bootstrap.min.js', 'bootstrap-editable.min',
                             'bootstrap-table.min.js', 'bootstrap-table-editable.min', 'semantic.min.js', 'jquery.validate.min.js', 'bootstrap-table-filter-control.min.js', 'semantic.js', plugin: 'kpi_report' %>
<% end %>
<script>
    $('#header').css("display", "none");
    $('#top-menu').css("height", "50px")
    $('#top-menu').css("z-index", "10")
    $('#top-menu').css("z-index", "10")
    $('.checkbox').css("display", "none");
    $('#top-menu').css("position", "relative")
</script>
<style>
  a {
    color: inherit !important;
  }

  #content {
    z-index: unset;
  }
  #kpi_table td {
    overflow: hidden;
    text-overflow: ellipsis;
    /*//white-space: nowrap;*/
    font-size: 12px;
  }
  #kpi_table th {
    font-size: 12px;
  }
  .select-css {
    display: block;
    font-size: 16px;
    font-family: sans-serif;
    font-weight: 700;
    color: #444;
    line-height: 1.3;
    padding: .6em 1.4em .5em .8em;
    width: 20%;
    max-width: 100%; /* useful when width is set to anything other than 100% */
    box-sizing: border-box;
    margin: 0;
    border: 1px solid #aaa;
    box-shadow: 0 1px 0 1px rgba(0,0,0,.04);
    border-radius: .5em;
    -moz-appearance: none;
    -webkit-appearance: none;
    appearance: none;
    background-color: #fff;

    linear-gradient(to bottom, #ffffff 0%,#e5e5e5 100%);
    background-repeat: no-repeat, repeat;
    background-position: right .7em top 50%, 0 0;
    background-size: .65em auto, 100%;
  }
  /* Hide arrow icon in IE browsers */
  .select-css::-ms-expand {
    display: none;
  }
  /* Hover style */
  .select-css:hover {
    border-color: #888;
  }
  /* Focus style */
  .select-css:focus {
    border-color: #aaa;
    /* It'd be nice to use -webkit-focus-ring-color here but it doesn't work on box-shadow */
    box-shadow: 0 0 1px 3px rgba(59, 153, 252, .7);
    box-shadow: 0 0 0 3px -moz-mac-focusring;
    color: #222;
    outline: none;
  }

  /* Set options to normal weight */
  .select-css option {
    font-weight:normal;
  }

  /* Support for rtl text, explicit support for Arabic and Hebrew */
  *[dir="rtl"] .select-css, :root:lang(ar) .select-css, :root:lang(iw) .select-css {
    background-position: left .7em top 50%, 0 0;
    padding: .6em .8em .5em 1.4em;
  }

  /* Disabled styles */
  .select-css:disabled, .select-css[aria-disabled=true] {
    color: graytext;
    background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22graytext%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'),
    linear-gradient(to bottom, #ffffff 0%,#e5e5e5 100%);
  }

  .select-css:disabled:hover, .select-css[aria-disabled=true] {
    border-color: #aaa;
  }
  .checkbox {
    padding-left: 10px;
    padding-top: 10px;
    outline: 1px solid #1e5180;
  }

  .checkbox input[type="checkbox"] {
    display: none;
  }

  .checkbox label {
    padding-left: 0;
  }

  .checkbox label:before {
    content: "";
    width: 20px;
    height: 20px;
    display: inline-block;
    vertical-align: bottom;
    margin-right: 10px;
    line-height: 20px;
    text-align: center;
    border: 1px solid #ccc;
    box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075);
    font-family: "Font Awesome 5 Solid";

  }

  .checkbox input[type="checkbox"]:checked+label::before {
    font-family: "Font Awesome 5 Solid";
    content: "\f00c";
    outline: 1px solid #1e5180;
  }

  .test {
    padding-left: 10px;
    padding-top: 10px;
  }
  .test .pseudo-element:before {
    display: none;
    font-family: "Font Awesome 5 Solid";
    content: "\f00c";
  }
    #table_sumnary1 td{
      white-space: nowrap;
    }
  #table_sumnary2 td{
    white-space: nowrap;
  }

</style>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>
<div>
  <div>
    <%= form_tag({:controller => 'cnbv_kpi', :action => 'index'}, :method => :get, :id => "query_form", style: "display:flex;padding:10px") do %>
      <table style="margin: 0 auto;">
        <tr>
          <td>
            <h4 style="margin: 0">Phụ lục 04A: Tổng hợp kết quả đánh giá mức độ hoàn thành nhiệm vụ/công việc của CBNV tại đơn vị </h4>
          </td>
          <td><%= select_tag "kidanhgia", options_for_select(Project.find(1072).versions.map { |obj| [obj.name, obj.id] }, $kidanhgia), :onchange => 'this.form.submit()', :style => 'font-weight: bold;' %></td>
        </tr>
      </table>
    <% end %>
  </div>
  <div>
    <div style="display: table;margin: 0 auto;">(Kèm theo Quyết định số: 2345/QĐ-CNVTQĐ-TCNL ngày 10 tháng 07 năm 2020 của Tổng Giám đốc Tập đoàn)
    </div>
  </div>
  <br>
  <input type="hidden" id="version_id1" value="<%=$kidanhgia %>">
  <input type="hidden" id="totalemployee" value="<%=@kpi_raking.size %>">
  <div style="margin-bottom: 20px">
    <div style="font-weight: bold;margin-bottom: 10px">I. Tổng hợp kết quả đánh giá, xếp loại</div>
    <div>
      <div style="width: 50%; float: left">
        <label>Nhóm CBNV còn lại</label>
        <table style="width: 80%;" id="table_sumnary2" class="table table-bordered striped table-responsive" >
          <thead style="background-color:#eee;">
          <tr>
            <th>Xếp loại Ki</th>
            <th>Tỷ lệ xếp loại Ki</th>
            <th>Số người</th>
            <th>Tỷ lệ đề xuất theo quy định</th>
            <th>Số người theo tỷ lệ đề xuất</th>
            <th>Ghi chú</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td>A+</td>
            <td></td>
            <td id="otNumAPlus"></td>
            <td>10%</td>
            <td></td>
            <td>Tỷ lệ Ki A+  ≤ 10%</td>
          </tr>
          <tr>
            <td>A</td>
            <td></td>
            <td id="otNumA"></td>
            <td>15%</td>
            <td></td>
            <td>Luỹ kế Ki A+ và A ≤ 25%</td>
          </tr>
          <tr>
            <td>B</td>
            <td></td>
            <td id="otNumB"></td>
            <td>60%</td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td>C</td>
            <td></td>
            <td id="otNumC"></td>
            <td>12%</td>
            <td></td>
            <td>Luỹ kế Ki C và D ≥ 15%</td>
          </tr>
          <tr>
            <td>D</td>
            <td></td>
            <td id="otNumD"></td>
            <td>3%</td>
            <td></td>
            <td>Tỷ lệ Ki D ≥ 3%</td>
          </tr>
          <tr>
            <td>K</td>
            <td></td>
            <td id="otNumK"></td>
            <td>N/A</td>
            <td>N/A</td>
            <td></td>
          </tr>
          <tr style="background-color: #E4FEFF">
            <td>Tổng:</td>
            <td></td>
            <td id="totalother"><%=@kpi_raking.size %></td>
            <td>100%</td>
            <td></td>
            <td></td>
          </tr>
          </tbody>
          <tfoot>

          </tfoot>
        </table>
      </div>
      <div style="width: 50%; float: left">
        <label>Nhóm CBNV được đánh giá theo tiêu chuẩn</label>
        <table style="width: 80%;" id="table_sumnary1" class="table table-bordered striped table-responsive" >
          <thead style="background-color:#eee;">
          <tr>
            <th>Xếp loại Ki</th>
            <th>Tỷ lệ xếp loại Ki</th>
            <th>Số người</th>
            <th>Tỷ lệ đề xuất theo quy định</th>
            <th>Số người theo tỷ lệ đề xuất</th>
            <th>Ghi chú</th>
          </tr>
          </thead>
          <tbody>
          <tr>
            <td>A+</td>
            <td></td>
            <td id="numAPlus"></td>
            <td>Không yêu cầu</td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td>A</td>
            <td></td>
            <td id="numA"></td>
            <td>15%</td>
            <td></td>
            <td>Luỹ kế Ki A và B ≤ 85%</td>
          </tr>
          <tr>
            <td>B</td>
            <td></td>
            <td id="numB"></td>
            <td>70%</td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td>C</td>
            <td></td>
            <td id="numC"></td>
            <td rowspan="2">15%</td>
            <td></td>
            <td>Luỹ kế Ki C và D ≥ 15%</td>
          </tr>
          <tr>
            <td>D</td>
            <td></td>
            <td id="numD"></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td>K</td>
            <td></td>
            <td id="numK"></td>
            <td>N/A</td>
            <td></td>
            <td></td>
          </tr>
          <tr style="background-color: #E4FEFF">
            <td>Tổng:</td>
            <td></td>
            <td id="totalprimary">0</td>
            <td>100%</td>
            <td></td>
            <td></td>
          <tr>
          </tbody>
          </tbody>
          <tfoot>

          </tfoot>
        </table>
      </div>
    </div>

    <br>
    <div>
    <div style="font-weight: bold;margin-bottom: 10px">II. Danh sách chi tiết</div>

    <table id="kpi_table" class="table table-bordered striped table-responsive" style="width: 100%">
      <thead style="background-color:#eee;">
      <tr>
        <th rowspan="4">TT</th>
        <th rowspan="4">Mã nhân viên</th>
        <th rowspan="4">Họ và tên</th>
<!--        <th rowspan="4">Chức danh</th>-->
<!--        <th rowspan="4">Đơn vị</th>-->
<!--        <th rowspan="4">Phòng ban</th>-->
<!--        <th rowspan="4">Tổ nhóm</th>-->
<!--        <th colspan="6" style="text-align:center">Kết quả hoàn thành nhiệm vụ/công việc <%#= Version.find($kidanhgia).name %></th>-->
        <th rowspan="4">Điểm đánh giá</th>
        <th rowspan="4">Xếp loại kết quả thực hiện mục tiêu nhiệm vụ/công việc</th>
        <th rowspan="4">Tuân thủ địa điểm làm việc</th>
        <th rowspan="4">Tuân thủ Nội quy lao động</th>
        <th rowspan="4">CBNV được đánh giá theo tiêu chuẩn<input type="checkbox" name="chk_all_goods" class="chk_all_goods" onClick="checkAll()"></th>
        <th rowspan="4">Xếp loại Ki</th>
        <th rowspan="4">Xếp loại mức độ hoàn thành nhiệm vụ/công việc</th>
        <th rowspan="4">Ghi chú, đề xuất của người quản lý trực tiếp với CBNV</th>
        <th rowspan="4" style="width: 200px">Ghi chú, đề xuất của người Chỉ huy với CBNV</th>
        <th rowspan="4" style="width: 200px">Chú ý</th>
        <th rowspan="4" >Hành động</th>
      </tr>


      </thead>
      <tbody>
      <% $num = 0 %>
      <% (1..@kpi_raking.size).each do |i| %>
      <tr  ki_id="<%= @ki_raking[$num][20] %>">
        <td><%= $num+1  %></td>
        <td><%= @kpi_raking[$num].employee_id %></td>
        <td><%= CustomValue.where(customized_id: @kpi_raking[$num].user_id, custom_field_id: 56).select(:value).take(1).nil? ? "N/A" : CustomValue.where(customized_id: @kpi_raking[$num].user_id, custom_field_id: 56).select(:value).take(1).first.value %></td>
<!--        <td><%#= @kpi_raking[$num].job_title %></td>-->
<!--        <td><%#= CustomValue.where(customized_id: @kpi_raking[$num].user_id, custom_field_id: 53).select(:value).take(1).nil? ? "N/A" : CustomValue.where(customized_id: @kpi_raking[$num].user_id, custom_field_id: 53).select(:value).take(1).first.value %></td>-->
<!--        <td><%#= CustomValue.where(customized_id: @kpi_raking[$num].user_id, custom_field_id: 54).select(:value).take(1).nil? ? "N/A" : CustomValue.where(customized_id: @kpi_raking[$num].user_id, custom_field_id: 54).select(:value).take(1).first.value %></td>-->
<!--        <td></td>-->
        <td><%=@ki_raking[$num][23] %></td>
        <td>
          <% if @ki_raking[$num][23].nil? %>
            Không đánh giá
          <% elsif @ki_raking[$num][23] < 2 %>
            Không đạt yêu cầu
          <% elsif 2<= @ki_raking[$num][23] < 2.5 %>
            Gần đạt yêu cầu
          <% elsif 2.5<= @ki_raking[$num][23] < 3.5 %>
            Đạt yêu cầu
          <% elsif 3.5<= @ki_raking[$num][23] < 4.5 %>
            Vượt yêu cầu
          <% elsif 4.5<= @ki_raking[$num][23] <= 5 %>
            Vượt xa yêu cầu
          <% end %>
        </td>
        <td>
          <select >
            <% if @ki_raking[$num][25] == 1 || @ki_raking[$num][25].nil?%>
              <option value="1" selected="selected">Tuân thủ</option>
              <option value="2">Không tuân thủ</option>
            <% elsif @ki_raking[$num][25] == 2 %>
              <option value="1">Tuân thủ</option>
              <option value="2" selected="selected">Không tuân thủ</option>
            <% end %>
          </select>
        </td>
        <td>
          <select>
            <% if @ki_raking[$num][26].nil? || @ki_raking[$num][26] == 1%>
              <option value="1" selected="selected">Tuân thủ</option>
              <option value="2">Vi phạm nhưng chưa đến mức bị xử lý kỷ luật</option>
              <option value="3">Bị xử lý kỷ luật lao động</option>
            <% elsif @ki_raking[$num][26] == 2 %>
              <option value="1">Tuân thủ</option>
              <option value="2" selected="selected">Vi phạm nhưng chưa đến mức bị xử lý kỷ luật</option>
              <option value="3">Bị xử lý kỷ luật lao động</option>
            <% elsif @ki_raking[$num][26] == 3 %>
              <option value="1">Tuân thủ</option>
              <option value="2">Vi phạm nhưng chưa đến mức bị xử lý kỷ luật</option>
              <option value="3" selected="selected">Bị xử lý kỷ luật lao động</option>
            <% end %>
          </select>
        </td>
        <td><input type="checkbox" name="chk_goods" class="chk_goods" onclick="CheckOne(this)"></td>
        <td>
          <select id="<%= "select_ki"+$num.to_s %>" onchange="mySelectKI(<%= $num %>)">
            <% if @ki_raking[$num][27].nil? or @ki_raking[$num][27]=="" %>
              <option value="" selected="selected"></option>
              <option value="A+" name="optionchange">A+</option>
              <option value="A">A</option>
              <option value="B">B</option>
              <option value="C">C</option>
              <option value="D">D</option>
              <option value="K">K</option>
            <% elsif @ki_raking[$num][27] == "A+" %>
              <option value="" selected="selected"></option>
              <option value="A+" selected="selected" name="optionchange">A+</option>
              <option value="A">A</option>
              <option value="B">B</option>
              <option value="C">C</option>
              <option value="D">D</option>
              <option value="K">K</option>
            <% elsif @ki_raking[$num][27] == "A" %>
              <option value="" selected="selected"></option>
              <option value="A+" name="optionchange">A+</option>
              <option value="A" selected="selected">A</option>
              <option value="B">B</option>
              <option value="C">C</option>
              <option value="D">D</option>
              <option value="K">K</option>
            <% elsif @ki_raking[$num][27] == "B" %>
              <option value="" selected="selected"></option>
              <option value="A+" name="optionchange">A+</option>
              <option value="A">A</option>
              <option value="B" selected="selected">B</option>
              <option value="C">C</option>
              <option value="D">D</option>
              <option value="K">K</option>
            <% elsif @ki_raking[$num][27] == "C" %>
              <option value="" selected="selected"></option>
              <option value="A+" name="optionchange">A+</option>
              <option value="A">A</option>
              <option value="B">B</option>
              <option value="C" selected="selected">C</option>
              <option value="D">D</option>
              <option value="K">K</option>
            <% elsif @ki_raking[$num][27] == "D" %>
              <option value="" selected="selected"></option>
              <option value="A+" name="optionchange">A+</option>
              <option value="A">A</option>
              <option value="B">B</option>
              <option value="C">C</option>
              <option value="D" selected="selected">D</option>
              <option value="K">K</option>
            <% elsif @ki_raking[$num][27] == "K" %>
              <option value="" selected="selected"></option>
              <option value="A+" name="optionchange">A+</option>
              <option value="A">A</option>
              <option value="B">B</option>
              <option value="C">C</option>
              <option value="D">D</option>
              <option value="K" selected="selected">K</option>
            <% end %>
          </select>
        </td>
        <td id="<%= "text_ki"+$num.to_s %>">
          <% if @ki_raking[$num][27].nil? or @ki_raking[$num][27]=="" %>
            Không đánh giá
          <% elsif @ki_raking[$num][27] == "A+" %>
            Vượt xa yêu cầu
          <% elsif @ki_raking[$num][27] == "A" %>
            Vượt yêu cầu
          <% elsif @ki_raking[$num][27] == "B" %>
            Đạt yêu cầu
          <% elsif @ki_raking[$num][27] == "C" %>
            Gần đạt yêu cầu
          <% elsif @ki_raking[$num][27] == "D" %>
            Không đạt yêu cầu
          <% elsif @ki_raking[$num][27] == "K" %>
            Không đánh giá
          <% end %>
        </td>
        <td>
          <% @comment = PeopleKiNote.where(user_id:@ki_raking[$num][0], version_id:$kidanhgia) %>
          <% $com = "" %>
          <% @comment.each do |cmt| %>
            <% $lead_name = User.find(cmt.lead_id).login %>
            <% $com << $lead_name %>
            <% $com << ":" %>
            <% $com << cmt.comment %>
            <% $com << "\n" %>
          <% end %>
          <%= $com %>
        </td>
        <td><textarea id="<%= "m_note"+$num.to_s %>" style="width:100%;"><%= @ki_raking[$num][30]  %></textarea> </td>
        <td><textarea id="<%= "note"+$num.to_s %>" style="width:100%;"><%= @ki_raking[$num][31]  %></textarea></td>
        <td>
          <a title="Lưu" href="#" onclick="saveChangeKI(this,<%=$num.to_s%>)" class="btn btn-primary">
            <i class="fa fa-check"></i>
          </a>
        </td>
        </tr>
          <% $num+=1 %>
      <% end %>
      </tbody>
      <tfoot>

      </tfoot>
    </table>
    </div>
  </div>
</div>
</body>
</html>

<script type="text/javascript" charset="utf-8">

    $( document ).ready(function() {
        rentCapacity();
    });

    function mySelectKI(num){
        let ki = $('#select_ki'+num).val();
        if (ki == "" || ki == "K"){
            $('#text_ki'+num).text("Không đánh giá");
        }
        else if(ki == "A+"){
            $('#text_ki'+num).text("Vượt xa yêu cầu");
        }
        else if(ki == "A"){
            $('#text_ki'+num).text("Vượt yêu cầu");
        }
        else if(ki == "B"){
            $('#text_ki'+num).text("Đạt yêu cầu");
        }
        else if(ki == "C"){
            $('#text_ki'+num).text("Gần đạt yêu cầu");
        }
        else if(ki == "D"){
            $('#text_ki'+num).text("Không đạt yêu cầu");
        }
        rentCapacity();
        

    }
    
    function saveChangeKI(btn,num){

        let data = $(btn).parent().parent()
        let ki_id = $(btn).parent().parent().attr("ki_id");
        let version_id = $('#version_id1').val();
        let empObj = {
            ki_id: ki_id,
            user_code: data.find("td:eq(1)").text(),
            version_id: version_id,
            location: data.find("select:eq(0)").val(),
            labor_rules: data.find("select:eq(1)").val(),
            ki: data.find("select:eq(2)").val(),
            manage_note: $('#m_note'+num).val(),
            note: $('#note'+num).val()
        };
        let url = 'http://' + $(location).attr('host') + '/kpi_ranking/save';
        $.ajax({
            type:"GET",
            url:url,
            dataType:"json",
            data: empObj,
            success:function(result) {
                //location.reload();
            },
            error: function(){
            }
        })
    }



    function checkAll() {

        if($('input[name="chk_all_goods"]').is(':checked')) {
            $('span').addClass( "on" );
            $( ".chk_goods" ).prop( "checked", true );
            $('#totalother').text(0);
            $('#totalprimary').text($('#totalemployee').val());
        } else {
            $('span').removeClass( "on" );
            $( ".chk_goods" ).prop( "checked", false );
            $('#totalother').text($('#totalemployee').val());
            $('#totalprimary').text(0);
        }
        rentCapacity();
    }
    function CheckOne(checkbox) {
        let a = checkbox;
        if(a.checked == true){
            $('#totalother').text(parseInt($('#totalother').text())-1);
            $('#totalprimary').text(parseInt($('#totalprimary').text())+1);
        }else{
            $('#totalother').text(parseInt($('#totalother').text())+1);
            $('#totalprimary').text(parseInt($('#totalprimary').text())-1);
        }
        rentCapacity();
    }

    function rentCapacity() {
        let otNumAPlus = 0;
        let otNumA = 0;
        let otNumB = 0;
        let otNumC = 0;
        let otNumD = 0;
        let otNumK = 0;
        let numAPlus = 0;
        let numA = 0;
        let numB = 0;
        let numC = 0;
        let numD = 0;
        let numK = 0;
        $('#kpi_table >tbody >tr').each(function (index, tr) {
            if($(tr.cells[7]).find("input").is(':checked') == true){
                if($(tr.cells[8]).find("select").val() == "A+"){
                    numAPlus += 1;
                }else if($(tr.cells[8]).find("select").val() == "A"){
                    numA  += 1;
                }else if($(tr.cells[8]).find("select").val() == "B"){
                    numB+=1;
                }else if($(tr.cells[8]).find("select").val() == "C"){
                    numC+=1;
                }else if($(tr.cells[8]).find("select").val() == "D"){
                    numD+=1;
                }else if($(tr.cells[8]).find("select").val() == "K"){
                    numK+=1;
                }else {
                    numK+=1;
                }

            }else{
                if($(tr.cells[8]).find("select").val() == "A+"){
                    otNumAPlus=otNumAPlus+1;
                }else if($(tr.cells[8]).find("select").val() == "A"){
                    otNumA+=1;
                }else if($(tr.cells[8]).find("select").val() == "B"){
                    otNumB+=1;
                }else if($(tr.cells[8]).find("select").val() == "C"){
                    otNumC+=1;
                }else if($(tr.cells[8]).find("select").val() == "D"){
                    otNumD+=1;
                }else if($(tr.cells[8]).find("select").val() == "K"){
                    otNumK+=1;
                }else {
                    otNumK+=1;
                }
            }
        })
        $('#otNumAPlus').text(otNumAPlus);
        $('#otNumA').text(otNumA);
        $('#otNumB').text(otNumB);
        $('#otNumC').text(otNumC);
        $('#otNumD').text(otNumD);
        $('#otNumK').text(otNumK);
        $('#numAPlus').text(numAPlus);
        $('#numA').text(numA);
        $('#numB').text(numB);
        $('#numC').text(numC);
        $('#numD').text(numD);
        $('#numK').text(numK);
    }
</script>